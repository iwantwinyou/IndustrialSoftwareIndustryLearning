**自动切换工单开发**



5.10

1.一些基本知识

![image-20240510154852976](E:/work/typora_220391/files/image-20240510154852976.png)

![image-20240510154910197](E:/work/typora_220391/files/image-20240510154910197.png)



2.上位机向下位机PLC发送信号：请求panelID

---》emit sgReqPanelID(sheet_id)---》void QSinspectSSServer::onNewSheet(int sheet_id)

![image-20240510170725559](E:/work/typora_220391/files/image-20240510170725559.png)



3.搞清楚AOI软件是如何跟下位机进行通信的完整流程。

配置文件：

![image-20240510172251672](E:/work/typora_220391/files/image-20240510172251672.png)

![image-20240510172319879](E:/work/typora_220391/files/image-20240510172319879.png)

数据通信：[ASCII码](https://so.csdn.net/so/search?q=ASCII码&spm=1001.2101.3001.7020)通信一般用与串口通信等通信上，数据量小、易于处理、便于调试，它虽然是文本模式，但本质仍然是二进制通信。

![image-20240510180449784](E:/work/typora_220391/files/image-20240510180449784.png)

上图是软件发送新片信息给plc，然后软件会返回sheet_id给软件（pannel_id）



5.11

思路梳理：

1、切换机型，软件去读机型是去哪读机型？（我知道的是文件夹model下）（大配方）

2、客户触摸屏切换机型是切换的软件的还是plc的？

3、plc读取地址内的型号跟软件型号有什么不一样？为啥会有不一致的情况？

4、软件收到型号之后，如果在model中没有找到对应型号？（这是可能发生的问题）

5、要做一个开关。(功能开关，通过配置文件来进行控制)

​	需要确认的是：功能配置文件在哪？原来测试代码是![image-20240511142841534](E:/work/typora_220391/files/image-20240511142841534.png)

6、我需要拿到的信息？

​	PLC发送的型号

​	拿到了信息我需要做什么处理？

​	自动切换工单

​	我的思路是：拿到工单型号-->设置到创建工单信息的生产型号-->执行点击确定之后的-->再点软件的开始按钮的流程？（问一下需不需要自动开始？判断一下软件状态，是在工作还是不再工作？在工作时，是不允许创建工单的）

7.客户切换型号，我这边如何进行测试？

8.界面改成RTP，配置文件如下

![image-20240513092058115](E:/work/typora_220391/files/image-20240513092058115.png)

9.不需要请求plc，直接接收就行

10.![image-20240513175418118](E:/work/typora_220391/files/image-20240513175418118.png)

仿写这段

解析他发给的QString



11.![image-20240514095549828](E:/work/typora_220391/files/image-20240514095549828.png)

1.解析了 协议的QString,发到2 ，2做中转，再把2的信号传给3，3写一个槽函数，更新新模板的数据内存。